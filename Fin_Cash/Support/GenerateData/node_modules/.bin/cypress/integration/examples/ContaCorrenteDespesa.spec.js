it("Cria conta corrente e despesa", function() {        
    cy.visit("https://en.wikipedia.org/wiki/List_of_largest_banks").then(
      () => {
        cy.wait(500).then(() => {                      
            cy.get('#By_total_assets').parent().next().next().next().next().next().find('tbody > tr').then(            
              elem => {                                                               
                cy.CreateArray(0, elem.length, []);
              }
            )
            cy.get('#By_market_capitalization').parent().next().next().next().next().find('tbody > tr').then(                        
              elem => {                                       
                cy.CreateArrayContaDespesa(0, elem.length, []);
              }
            )
        });
      }
    );
  });

  Cypress.Commands.add('CreateArray', (i, length, arrContaCorrente) => {    
    if (i < length) {                
        cy.get('#By_total_assets').parent().next().next().next().next().next().find('tbody > tr').eq(i).find('td').eq(1).then(            
            e => {                                                                                                      
                var obj = {
                  id: i + 1,
                  name: e[0].innerText
                };
                arrContaCorrente.push(obj);                
            }            
        );         
        cy.writeFile('ContaCorrente.json', arrContaCorrente);
        cy.CreateArray(i + 1, length, arrContaCorrente);
    }
    else
    {                
        console.log("Process ended");
    }
})

Cypress.Commands.add('CreateArrayContaDespesa', (j, length, arrContaDespesa) => {        
  if (j < length) {             
    cy.get('#By_market_capitalization').parent().next().next().next().next().find('tbody > tr').eq(j).find('td').eq(1).then(   
          e => {                                                                                                    
              var obj = {
                id: j + 1,
                name: e[0].innerText
              };
              arrContaDespesa.push(obj);
          }            
      );                      
      cy.writeFile('ContaDespesa.json', arrContaDespesa);
      cy.CreateArrayContaDespesa(j + 1, length, arrContaDespesa);
  }
  else
  {                
      console.log("Process ended");
  }
})